# --------------------------------------------------------------------
def tap_uint16(x, i):
    return (x >> i) & 1

# --------------------------------------------------------------------
def polytap_uint16(x, I):
    m = 0
    for i in I:
        m ^= tap_uint16(x, i)
    return m

# --------------------------------------------------------------------
def lfsr_uint16(X, I):
    return (polytap_uint16(X, I) << 15) | (X >> 1)
